var e,t,r;e=new(function(){var e;function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];(function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")})(this,t),this.board=e,this.score=0}return e=[{key:"filterZero",value:function(e){return e.filter(function(e){return 0!==e})}},{key:"renderBoard",value:function(){for(var e=document.querySelectorAll(".game-field td"),t=0;t<4;t++)for(var r=0;r<4;r++){var s=e[4*t+r],o=this.board[t][r];s.classList="field-cell",0===o?s.textContent="":(s.textContent=o,s.classList.add("field-cell--".concat(o)))}document.querySelector(".game-score").textContent="".concat(this.score)}},{key:"spawnNumber",value:function(){for(var e=[],t=0;t<4;t++)for(var r=0;r<4;r++)0===this.board[t][r]&&e.push({row:t,col:r});if(0!==e.length){var s=e[Math.floor(Math.random()*e.length)],o=.1>Math.random()?4:2;this.board[s.row][s.col]=o,this.renderBoard()}}},{key:"isGameOver",value:function(){for(var e=0;e<4;e++)for(var t=0;t<4;t++)if(2048===this.board[e][t])return"win";for(var r=0;r<4;r++)for(var s=0;s<4;s++)if(0===this.board[r][s]||s<3&&this.board[r][s]===this.board[r][s+1]||r<3&&this.board[r][s]===this.board[r+1][s])return"playing";return"lose"}},{key:"moveLeft",value:function(){for(var e=0;e<4;e++){var t=this.board[e];t=this.filterZero(t);for(var r=0;r<t.length-1;r++)t[r]===t[r+1]&&(t[r]*=2,t[r+1]=0,this.score+=t[r]);for(t=this.filterZero(t);t.length<4;)t.push(0);this.board[e]=t}this.renderBoard(),this.spawnNumber(),this.checkGameStatus()}},{key:"moveRight",value:function(){for(var e=0;e<4;e++){var t=this.board[e].reverse();t=this.filterZero(t);for(var r=0;r<t.length-1;r++)t[r]===t[r+1]&&(t[r]*=2,t[r+1]=0,this.score+=t[r]);for(t=this.filterZero(t);t.length<4;)t.push(0);this.board[e]=t.reverse()}this.renderBoard(),this.spawnNumber(),this.checkGameStatus()}},{key:"moveUp",value:function(){for(var e=0;e<4;e++){for(var t=[],r=0;r<4;r++)t.push(this.board[r][e]);t=this.filterZero(t);for(var s=0;s<t.length-1;s++)t[s]===t[s+1]&&(t[s]*=2,t[s+1]=0,this.score+=t[s]);for(t=this.filterZero(t);t.length<4;)t.push(0);for(var o=0;o<4;o++)this.board[o][e]=t[o]}this.renderBoard(),this.spawnNumber(),this.checkGameStatus()}},{key:"moveDown",value:function(){for(var e=0;e<4;e++){for(var t=[],r=0;r<4;r++)t.push(this.board[r][e]);(t=this.filterZero(t)).reverse();for(var s=0;s<t.length-1;s++)t[s]===t[s+1]&&(t[s]*=2,t[s+1]=0,this.score+=t[s]);for(t=this.filterZero(t);t.length<4;)t.push(0);t.reverse();for(var o=0;o<4;o++)this.board[o][e]=t[o]}this.renderBoard();var a=JSON.stringify(this.getState());this.currentBoard!==a&&this.spawnNumber(),this.checkGameStatus()}},{key:"getScore",value:function(){return this.score}},{key:"getState",value:function(){return this.board}},{key:"getStatus",value:function(){var e=document.querySelector(".message-container").querySelector("p:not(.hidden)");if(!e)return"playing";switch(e.classList){case"message message-start":return"idle";case"message message-win":return"win";case"message message-lose":return"lose"}}},{key:"checkGameStatus",value:function(){var e=this.isGameOver();("win"===e||"lose"===e)&&this.showMessage(e)}},{key:"showMessage",value:function(e){document.querySelector(".message.message-".concat(e)).classList.remove("hidden"),document.removeEventListener("keydown",this.boundKeyDown)}},{key:"start",value:function(){var e=this,t=document.querySelectorAll(".game-field td");Array.from({length:t.length},function(e,t){return t}).sort(function(){return .5-Math.random()}).slice(0,2).forEach(function(r){t[r].textContent="2",t[r].classList.add("field-cell--2");var s=Math.floor(r/4);e.board[s][r%4]=2}),document.querySelector(".message.message-start").classList.add("hidden"),this.boundKeyDown=this.keyDown.bind(this),document.addEventListener("keydown",this.boundKeyDown)}},{key:"restart",value:function(){document.querySelectorAll(".game-field td").forEach(function(e){e.classList="field-cell",e.textContent=""});for(var e=0;e<4;e++)for(var t=0;t<4;t++)this.board[e][t]=0;document.querySelector(".message.message-start").classList.remove("hidden"),document.removeEventListener("keydown",this.boundKeyDown)}},{key:"keyDown",value:function(e){switch(e.preventDefault(),e.key){case"ArrowUp":this.moveUp();break;case"ArrowDown":this.moveDown();break;case"ArrowLeft":this.moveLeft();break;case"ArrowRight":this.moveRight()}this.checkGameStatus()}}],function(e,t){for(var r=0;r<t.length;r++){var s=t[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}(t.prototype,e),t}()),t=document.querySelector("button.start"),r=0,t.addEventListener("click",function(s){++r%2==1?(t.classList.remove("start"),t.classList.add("restart"),t.textContent="Restart",e.start()):(t.classList.remove("restart"),t.classList.add("start"),t.textContent="Start",e.restart())});
//# sourceMappingURL=index.1c32688a.js.map
